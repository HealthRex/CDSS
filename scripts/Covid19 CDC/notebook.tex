
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{long\_tbl\_grp\_person}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{c+c1}{\PYZsh{} Header from RIT notebook}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        \PY{c+c1}{\PYZsh{}\PYZsh{}Setting up Google sdk environment}
        \PY{k+kn}{import} \PY{n+nn}{os} 
        \PY{n}{os}\PY{o}{.}\PY{n}{environ}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GOOGLE\PYZus{}APPLICATION\PYZus{}CREDENTIALS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/home/marcelkc/.config/gcloud/application\PYZus{}default\PYZus{}credentials.json}\PY{l+s+s1}{\PYZsq{}} 
        \PY{n}{os}\PY{o}{.}\PY{n}{environ}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GCLOUD\PYZus{}PROJECT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{som\PYZhy{}nero\PYZhy{}phi\PYZhy{}nigam\PYZhy{}starr}\PY{l+s+s1}{\PYZsq{}} \PY{c+c1}{\PYZsh{}som\PYZhy{}nero\PYZhy{}phi\PYZhy{}rit}
        \PY{o}{\PYZpc{}}\PY{k}{load\PYZus{}ext} google.cloud.bigquery
        \PY{c+c1}{\PYZsh{}\PYZsh{}Setting up BQ API}
        \PY{k+kn}{from} \PY{n+nn}{google}\PY{n+nn}{.}\PY{n+nn}{cloud} \PY{k}{import} \PY{n}{bigquery}
        \PY{n}{client}\PY{o}{=}\PY{n}{bigquery}\PY{o}{.}\PY{n}{Client}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/share/sw/open/anaconda/3/lib/python3.6/site-packages/google/auth/\_default.py:66: UserWarning: Your application has authenticated using end user credentials from Google Cloud SDK. We recommend that most server applications use service accounts instead. If your application continues to use end user credentials from Cloud SDK, you might receive a "quota exceeded" or "API not enabled" error. For more information about service accounts, see https://cloud.google.com/docs/authentication/
  warnings.warn(\_CLOUD\_SDK\_CREDENTIALS\_WARNING)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{query} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}\PY{l+s+s2}{SELECT }
        \PY{l+s+s2}{v.person\PYZus{}id, }
        \PY{l+s+s2}{visit\PYZus{}start\PYZus{}DATETIME, }
        \PY{l+s+s2}{ARI\PYZus{}symptoms\PYZus{}2\PYZus{}months, }
        \PY{l+s+s2}{race\PYZus{}concept\PYZus{}id, ethnicity\PYZus{}concept\PYZus{}id, \PYZsh{} race/ethnicity}
        \PY{l+s+s2}{gender\PYZus{}concept\PYZus{}id, \PYZsh{} gender}
        \PY{l+s+s2}{year\PYZus{}of\PYZus{}birth, month\PYZus{}of\PYZus{}birth, day\PYZus{}of\PYZus{}birth, \PYZsh{} age at present}
        \PY{l+s+s2}{visit\PYZus{}concept\PYZus{}id, care\PYZus{}site\PYZus{}name, \PYZsh{} location}
        \PY{l+s+s2}{value\PYZus{}source\PYZus{}value, \PYZsh{} test result}
        \PY{l+s+s2}{visit\PYZus{}occurrence\PYZus{}id}
        \PY{l+s+s2}{FROM `som\PYZhy{}rit\PYZhy{}phi\PYZhy{}starr\PYZhy{}prod.starr\PYZus{}omop\PYZus{}cdm5\PYZus{}deid\PYZus{}latest.visit\PYZus{}occurrence` v}
        
        \PY{l+s+s2}{LEFT JOIN(}
        \PY{l+s+s2}{  \PYZsh{}visit\PYZus{}occurrence\PYZus{}id (unique) to ARI\PYZus{}symptoms}
        \PY{l+s+s2}{  SELECT }
        \PY{l+s+s2}{  visit\PYZus{}occurrence\PYZus{}id,}
        \PY{l+s+s2}{  \PYZsh{}ARI symptoms \PYZsh{} any condition\PYZus{}start\PYZus{}DATETIME, condition\PYZus{}end\PYZus{}DATETIME within 2 months}
        \PY{l+s+s2}{  max(}
        \PY{l+s+s2}{  DATETIME\PYZus{}DIFF(visit\PYZus{}start\PYZus{}DATETIME, condition\PYZus{}start\PYZus{}DATETIME, MONTH) \PYZlt{} 2}
        \PY{l+s+s2}{  OR}
        \PY{l+s+s2}{  DATETIME\PYZus{}DIFF(visit\PYZus{}start\PYZus{}DATETIME, condition\PYZus{}end\PYZus{}DATETIME, MONTH) \PYZlt{} 2 }
        \PY{l+s+s2}{  )}
        \PY{l+s+s2}{  AS ARI\PYZus{}symptoms\PYZus{}2\PYZus{}months,}
        \PY{l+s+s2}{  FROM `som\PYZhy{}rit\PYZhy{}phi\PYZhy{}starr\PYZhy{}prod.starr\PYZus{}omop\PYZus{}cdm5\PYZus{}deid\PYZus{}latest.visit\PYZus{}occurrence` v}
        \PY{l+s+s2}{  LEFT JOIN (}
        \PY{l+s+s2}{    SELECT person\PYZus{}id, condition\PYZus{}start\PYZus{}DATETIME, condition\PYZus{}end\PYZus{}DATETIME, }
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value, condition\PYZus{}source\PYZus{}concept\PYZus{}id \PYZsh{} might get used later}
        \PY{l+s+s2}{    FROM `som\PYZhy{}rit\PYZhy{}phi\PYZhy{}starr\PYZhy{}prod.starr\PYZus{}omop\PYZus{}cdm5\PYZus{}deid\PYZus{}latest.condition\PYZus{}occurrence`}
        \PY{l+s+s2}{    WHERE (condition\PYZus{}start\PYZus{}DATETIME \PYZgt{}= }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{2019\PYZhy{}11\PYZhy{}01T00:00:00.000}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR condition\PYZus{}end\PYZus{}DATETIME \PYZgt{}= }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{2019\PYZhy{}11\PYZhy{}01T00:00:00.000}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{)}
        \PY{l+s+s2}{    AND}
        \PY{l+s+s2}{    (condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J00.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J01.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J02.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J03.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J04.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J05.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J06.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J09.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J10.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J11.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J12.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J13.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J14.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J15.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J16.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J17.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J18.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J20.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J21.}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J22}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{J80}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{A37.91}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{A37.01}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{A37.11}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{A37.81}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{A48.1}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{B25.0}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{B44.0}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{B97.4}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ OR}
        \PY{l+s+s2}{    condition\PYZus{}source\PYZus{}value LIKE }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{U07.1}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{)}
        \PY{l+s+s2}{  ) USING (person\PYZus{}id)}
        \PY{l+s+s2}{  WHERE visit\PYZus{}start\PYZus{}DATETIME \PYZgt{}= }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{2020\PYZhy{}02\PYZhy{}01T00:00:00.000}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ \PYZsh{} all encounters from feb 1}
        \PY{l+s+s2}{  GROUP BY visit\PYZus{}occurrence\PYZus{}id}
        \PY{l+s+s2}{  )}
        \PY{l+s+s2}{USING (visit\PYZus{}occurrence\PYZus{}id)}
        
        
        \PY{l+s+s2}{LEFT JOIN (}
        \PY{l+s+s2}{  \PYZsh{} visit\PYZus{}occurrence\PYZus{}id to covid test result (value\PYZus{}source\PYZus{}value) }
        \PY{l+s+s2}{  SELECT value\PYZus{}source\PYZus{}value, \PYZsh{} test result}
        \PY{l+s+s2}{  visit\PYZus{}occurrence\PYZus{}id \PYZsh{} for mapping(s)}
        \PY{l+s+s2}{  FROM `som\PYZhy{}rit\PYZhy{}phi\PYZhy{}starr\PYZhy{}prod.starr\PYZus{}omop\PYZus{}cdm5\PYZus{}deid\PYZus{}latest.measurement`}
        \PY{l+s+s2}{  WHERE measurement\PYZus{}concept\PYZus{}id = 706170}
        \PY{l+s+s2}{) }
        \PY{l+s+s2}{USING (visit\PYZus{}occurrence\PYZus{}id)}
        
        \PY{l+s+s2}{INNER JOIN `som\PYZhy{}rit\PYZhy{}phi\PYZhy{}starr\PYZhy{}prod.starr\PYZus{}omop\PYZus{}cdm5\PYZus{}deid\PYZus{}latest.person` USING (person\PYZus{}id)}
        
        \PY{l+s+s2}{LEFT JOIN `som\PYZhy{}rit\PYZhy{}phi\PYZhy{}starr\PYZhy{}prod.starr\PYZus{}omop\PYZus{}cdm5\PYZus{}deid\PYZus{}latest.care\PYZus{}site` c  }
        \PY{l+s+s2}{ON c.care\PYZus{}site\PYZus{}id = v.care\PYZus{}site\PYZus{}id}
        
        \PY{l+s+s2}{WHERE visit\PYZus{}start\PYZus{}DATETIME \PYZgt{}= }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{2020\PYZhy{}02\PYZhy{}01T00:00:00.000}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ \PYZsh{} all encounters from feb 1}\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{n}{query\PYZus{}job} \PY{o}{=} \PY{n}{client}\PY{o}{.}\PY{n}{query}\PY{p}{(}\PY{n}{query}\PY{p}{)}
        \PY{n}{df} \PY{o}{=} \PY{n}{query\PYZus{}job}\PY{o}{.}\PY{n}{to\PYZus{}dataframe}\PY{p}{(}\PY{n}{progress\PYZus{}bar\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tqdm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Downloading: 100\%|██████████| 1835715/1835715 [04:05<00:00, 7751.50rows/s]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{long\PYZus{}table\PYZus{}cdc.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}3}]:}    person\_id visit\_start\_DATETIME ARI\_symptoms\_2\_months  race\_concept\_id  \textbackslash{}
        0   31729010           2020-03-14                  None             8527   
        1   30424583           2020-02-11                  True             8527   
        2   30106192           2020-03-01                  True                0   
        3   31496809           2020-04-08                  None             8527   
        4   31100057           2020-03-07                  True             8527   
        
           ethnicity\_concept\_id  gender\_concept\_id  year\_of\_birth  month\_of\_birth  \textbackslash{}
        0              38003564               8532           1932               9   
        1              38003564               8507           1932              11   
        2              38003563               8532           1931               5   
        3              38003564               8507           1930              11   
        4                     0               8507           1931               9   
        
           day\_of\_birth  visit\_concept\_id                             care\_site\_name  \textbackslash{}
        0            11                 0                        LAB BVMG PLEASANTON   
        1            27                 0                       STANFORD SENIOR CARE   
        2            31                 0       INTERNAL MEDICINE SAMARITAN SAN JOSE   
        3             8                 0                               VCP LAB DRAW   
        4            18                 0  INTERNAL MEDICINE MANOUKIAN MOUNTAIN VIEW   
        
          value\_source\_value  visit\_occurrence\_id  
        0               None            159694443  
        1               None            157916468  
        2               None            161109490  
        3               None            163427116  
        4               None            160595775  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{c+c1}{\PYZsh{} positive\PYZus{}test}
        \PY{n}{positive\PYZus{}value\PYZus{}source\PYZus{}value} \PY{o}{=} \PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Detected}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DETECTED}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pos}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{pos\PYZus{}test\PYZus{}bool} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{value\PYZus{}source\PYZus{}value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{positive\PYZus{}value\PYZus{}source\PYZus{}value}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{positive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} tested}
        \PY{n}{test\PYZus{}bool} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{value\PYZus{}source\PYZus{}value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{notnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tested}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} ARI\PYZus{}sympt}
        \PY{n}{ARI\PYZus{}2\PYZus{}mon} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ARI\PYZus{}symptoms\PYZus{}2\PYZus{}months}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{k+kc}{True}
        \PY{n}{ARI\PYZus{}2\PYZus{}mon} \PY{o}{=} \PY{n}{ARI\PYZus{}2\PYZus{}mon}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ARI\PYZus{}symptoms\PYZus{}2\PYZus{}months\PYZus{}bool}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} age results}
        \PY{n}{visit\PYZus{}dt} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visit\PYZus{}start\PYZus{}DATETIME}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x} \PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{)}
        \PY{n}{pat\PYZus{}bd\PYZus{}dt} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year\PYZus{}of\PYZus{}birth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month\PYZus{}of\PYZus{}birth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}birth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{x}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{pat\PYZus{}age} \PY{o}{=} \PY{n}{visit\PYZus{}dt} \PY{o}{\PYZhy{}} \PY{n}{pat\PYZus{}bd\PYZus{}dt}
        \PY{n}{pat\PYZus{}age} \PY{o}{=} \PY{n}{pat\PYZus{}age}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x}\PY{o}{.}\PY{n}{days}\PY{o}{/}\PY{l+m+mf}{365.25}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} age categorical}
        \PY{n}{bins} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{18}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{65}\PY{p}{,} \PY{l+m+mi}{75}\PY{p}{,} \PY{l+m+mi}{85}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{]}
        \PY{n}{labels} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{[}\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s2}{, }\PY{l+s+si}{\PYZob{}1\PYZcb{}}\PY{l+s+s2}{)}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i}\PY{p}{,} \PY{n}{j}\PY{p}{)} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{bins}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{bins}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{)}\PY{p}{]}
        \PY{n}{age\PYZus{}cat} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{cut}\PY{p}{(}\PY{n}{pat\PYZus{}age}\PY{p}{,} \PY{n}{bins}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{labels}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{df\PYZus{}all} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{pos\PYZus{}test\PYZus{}bool}\PY{p}{,} \PY{n}{test\PYZus{}bool}\PY{p}{,} \PY{n}{age\PYZus{}cat}\PY{p}{,} \PY{n}{df}\PY{p}{,} \PY{n}{ARI\PYZus{}2\PYZus{}mon}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{df\PYZus{}all}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1}
        \PY{n}{df\PYZus{}all}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}5}]:}    positive  tested        age  person\_id visit\_start\_DATETIME  \textbackslash{}
        0     False   False  [85, 100)   31729010           2020-03-14   
        1     False   False  [85, 100)   30424583           2020-02-11   
        2     False   False  [85, 100)   30106192           2020-03-01   
        3     False   False  [85, 100)   31496809           2020-04-08   
        4     False   False  [85, 100)   31100057           2020-03-07   
        
          ARI\_symptoms\_2\_months  race\_concept\_id  ethnicity\_concept\_id  \textbackslash{}
        0                  None             8527              38003564   
        1                  True             8527              38003564   
        2                  True                0              38003563   
        3                  None             8527              38003564   
        4                  True             8527                     0   
        
           gender\_concept\_id  year\_of\_birth  month\_of\_birth  day\_of\_birth  \textbackslash{}
        0               8532           1932               9            11   
        1               8507           1932              11            27   
        2               8532           1931               5            31   
        3               8507           1930              11             8   
        4               8507           1931               9            18   
        
           visit\_concept\_id                             care\_site\_name  \textbackslash{}
        0                 0                        LAB BVMG PLEASANTON   
        1                 0                       STANFORD SENIOR CARE   
        2                 0       INTERNAL MEDICINE SAMARITAN SAN JOSE   
        3                 0                               VCP LAB DRAW   
        4                 0  INTERNAL MEDICINE MANOUKIAN MOUNTAIN VIEW   
        
          value\_source\_value  visit\_occurrence\_id  ARI\_symptoms\_2\_months\_bool  total  
        0               None            159694443                       False      1  
        1               None            157916468                        True      1  
        2               None            161109490                        True      1  
        3               None            163427116                       False      1  
        4               None            160595775                        True      1  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{k}{def} \PY{n+nf}{visualize\PYZus{}col}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{col\PYZus{}nm}\PY{p}{)}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{col\PYZus{}nm}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{)}
            
            \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
            \PY{n}{df}\PY{p}{[}\PY{n}{col\PYZus{}nm}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            
            \PY{n}{tbl} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{pivot\PYZus{}table}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{values}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tested}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{positive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ARI\PYZus{}symptoms\PYZus{}2\PYZus{}months\PYZus{}bool}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visit\PYZus{}concept\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{n}{col\PYZus{}nm}\PY{p}{]}\PY{p}{,} \PY{n}{aggfunc}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{)}
            \PY{k}{return} \PY{n}{tbl}\PY{o}{.}\PY{n}{T}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{k}{def} \PY{n+nf}{get\PYZus{}groupby\PYZus{}max}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{group\PYZus{}by\PYZus{}ls}\PY{p}{)}\PY{p}{:}
            \PY{n}{df\PYZus{}dups\PYZus{}ind} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{duplicated}\PY{p}{(}\PY{n}{group\PYZus{}by\PYZus{}ls}\PY{p}{,} \PY{n}{keep}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
            \PY{n}{df\PYZus{}dups} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{n}{df\PYZus{}dups\PYZus{}ind}\PY{p}{]}
            \PY{n}{df\PYZus{}n\PYZus{}dups} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{n}{df\PYZus{}dups\PYZus{}ind} \PY{o}{==} \PY{k+kc}{False}\PY{p}{]}
        
            \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n+nb}{len}\PY{p}{,} \PY{p}{[}\PY{n}{df\PYZus{}dups\PYZus{}ind}\PY{p}{,} \PY{n}{df\PYZus{}dups}\PY{p}{,} \PY{n}{df\PYZus{}n\PYZus{}dups}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
        
            \PY{n}{uniq\PYZus{}by\PYZus{}grp} \PY{o}{=} \PY{p}{[}\PY{n}{grp}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{positive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tested}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{care\PYZus{}site\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                \PY{k}{for} \PY{n}{ind}\PY{p}{,} \PY{n}{grp} \PY{o+ow}{in} \PY{n}{df\PYZus{}dups}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{group\PYZus{}by\PYZus{}ls}\PY{p}{,} \PY{n}{sort}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{]}
            \PY{n}{df\PYZus{}d\PYZus{}dups} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{n}{uniq\PYZus{}by\PYZus{}grp}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{T}
        
            \PY{n}{df\PYZus{}uniq\PYZus{}by\PYZus{}grp} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{df\PYZus{}d\PYZus{}dups}\PY{p}{,} \PY{n}{df\PYZus{}n\PYZus{}dups}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
            \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n+nb}{len}\PY{p}{,} \PY{p}{[}\PY{n}{df\PYZus{}d\PYZus{}dups}\PY{p}{,} \PY{n}{df\PYZus{}n\PYZus{}dups}\PY{p}{,} \PY{n}{df\PYZus{}uniq\PYZus{}by\PYZus{}grp}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
            \PY{k}{return} \PY{n}{df\PYZus{}uniq\PYZus{}by\PYZus{}grp}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{df\PYZus{}uniq\PYZus{}vids} \PY{o}{=} \PY{n}{get\PYZus{}groupby\PYZus{}max}\PY{p}{(}\PY{n}{df\PYZus{}all}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visit\PYZus{}occurrence\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[1835715, 32244, 1803471]
[15968, 1803471, 1819439]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{df\PYZus{}uniq\PYZus{}person\PYZus{}times} \PY{o}{=} \PY{n}{get\PYZus{}groupby\PYZus{}max}\PY{p}{(}\PY{n}{df\PYZus{}uniq\PYZus{}vids}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{person\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[1819439, 1726771, 92668]
[269963, 92668, 362631]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{df} \PY{o}{=} \PY{n}{df\PYZus{}uniq\PYZus{}person\PYZus{}times}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} should all be [0,1]}
         \PY{k}{for} \PY{n}{elt} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tested}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{positive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ARI\PYZus{}symptoms\PYZus{}2\PYZus{}months\PYZus{}bool}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
             \PY{n}{df}\PY{p}{[}\PY{n}{elt}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{elt}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{int32}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{elt}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[1 0]
[0 1]
[1]
[1 0]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{c+c1}{\PYZsh{}person\PYZus{}id, care\PYZus{}site\PYZus{}name, visit\PYZus{}concept\PYZus{}id}
         \PY{n}{len\PYZus{}uniq} \PY{o}{=} \PY{k}{lambda} \PY{n}{col}\PY{p}{:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{df\PYZus{}uniq\PYZus{}person\PYZus{}times}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n}{my\PYZus{}disp} \PY{o}{=} \PY{k}{lambda} \PY{n}{col}\PY{p}{:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{:}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{col}\PY{p}{,} \PY{n}{len\PYZus{}uniq}\PY{p}{(}\PY{n}{col}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total:}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{df\PYZus{}uniq\PYZus{}person\PYZus{}times}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{my\PYZus{}disp}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{person\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{my\PYZus{}disp}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{care\PYZus{}site\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{my\PYZus{}disp}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{visit\PYZus{}occurrence\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{pre}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{uniq\PYZus{}}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{care\PYZus{}site\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{pre}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{care\PYZus{}counts\PYZus{}all\PYZus{}visit.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{care\PYZus{}site\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ARI\PYZus{}symptoms\PYZus{}2\PYZus{}months\PYZus{}bool}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{pre}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{care\PYZus{}counts\PYZus{}ari\PYZus{}visit.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{care\PYZus{}site\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tested}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{pre}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{care\PYZus{}counts\PYZus{}test\PYZus{}visit.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{care\PYZus{}site\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{positive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{pre}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{care\PYZus{}counts\PYZus{}pos\PYZus{}test\PYZus{}visit.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n}{df\PYZus{}uniq\PYZus{}person\PYZus{}times}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
total:362631
person\_id:362631
care\_site\_name:1387
visit\_occurrence\_id:362631
positive                           0
tested                             0
age                              611
person\_id                          0
visit\_start\_DATETIME               0
ARI\_symptoms\_2\_months         336555
race\_concept\_id                    0
ethnicity\_concept\_id               0
gender\_concept\_id                  0
year\_of\_birth                      0
month\_of\_birth                     0
day\_of\_birth                       0
visit\_concept\_id                   0
care\_site\_name                  3342
value\_source\_value            350311
visit\_occurrence\_id                0
ARI\_symptoms\_2\_months\_bool         0
total                              0
dtype: int64

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}27}]:}      positive tested        age person\_id visit\_start\_DATETIME  \textbackslash{}
         492     False   True  [85, 100)  32031651  2020-04-26 00:00:00   
         543      True   True  [85, 100)  32168960  2020-04-23 00:00:00   
         689     False   True  [85, 100)  32410794  2020-04-08 00:00:00   
         779     False   True  [85, 100)  31985357  2020-04-02 00:00:00   
         1523    False   True  [85, 100)  30531941  2020-03-03 00:00:00   
         
              ARI\_symptoms\_2\_months race\_concept\_id ethnicity\_concept\_id  \textbackslash{}
         492                   True            8527             38003564   
         543                   True            8527             38003564   
         689                   None               0                    0   
         779                   None               0             38003563   
         1523                  True               0                    0   
         
              gender\_concept\_id year\_of\_birth month\_of\_birth day\_of\_birth  \textbackslash{}
         492               8507          1931              5            3   
         543               8507          1932              9            2   
         689               8532          1932             12           22   
         779               8532          1932              8           28   
         1523              8532          1932              4            9   
         
              visit\_concept\_id                  care\_site\_name value\_source\_value  \textbackslash{}
         492              9201                            None       Not Detected   
         543              9201                            None           Detected   
         689                 0             HILLVIEW LABORATORY       Not Detected   
         779              9201                            None       Not Detected   
         1523             9202  STANFORD EXPRESS CARE SAN JOSE       Not Detected   
         
              visit\_occurrence\_id ARI\_symptoms\_2\_months\_bool total  
         492            163856137                       True     1  
         543            163982679                       True     1  
         689            163453750                      False     1  
         779            163986642                      False     1  
         1523           163450296                       True     1  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{visualize\PYZus{}col}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[18, 50)     119791
[50, 65)      77156
[65, 75)      53162
[5, 18)       47461
[75, 85)      32317
[0, 5)        24292
[85, 100)      7841
Name: age, dtype: int64

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}28}]:} visit\_concept\_id                         0       9201     9202  9203
                                    age                                      
         ARI\_symptoms\_2\_months\_bool [0, 5)      1833.0    89.0   2693.0   NaN
                                    [18, 50)    5252.0   376.0   2513.0   2.0
                                    [5, 18)     2031.0   156.0   3611.0   NaN
                                    [50, 65)    2332.0   382.0    914.0   0.0
                                    [65, 75)    1217.0   233.0    364.0   0.0
                                    [75, 85)     663.0   133.0    161.0   0.0
                                    [85, 100)    195.0    38.0     46.0   NaN
         positive                   [0, 5)         5.0     0.0      0.0   NaN
                                    [18, 50)     419.0    45.0     32.0   0.0
                                    [5, 18)       23.0     0.0      1.0   NaN
                                    [50, 65)     220.0    36.0     34.0   0.0
                                    [65, 75)     117.0    13.0     10.0   0.0
                                    [75, 85)      70.0    22.0      5.0   0.0
                                    [85, 100)     28.0     5.0      2.0   NaN
         tested                     [0, 5)       408.0     6.0      1.0   NaN
                                    [18, 50)    5010.0   445.0    643.0   0.0
                                    [5, 18)      457.0     4.0     19.0   NaN
                                    [50, 65)    1926.0   514.0    425.0   1.0
                                    [65, 75)    1003.0   249.0    156.0   1.0
                                    [75, 85)     564.0   174.0     54.0   0.0
                                    [85, 100)    202.0    48.0     10.0   NaN
         total                      [0, 5)     12538.0  1010.0  10744.0   NaN
                                    [18, 50)   89804.0  7113.0  22862.0  12.0
                                    [5, 18)    26507.0  3506.0  17448.0   NaN
                                    [50, 65)   58225.0  6601.0  12325.0   5.0
                                    [65, 75)   40397.0  4886.0   7876.0   3.0
                                    [75, 85)   25004.0  2618.0   4693.0   2.0
                                    [85, 100)   6248.0   496.0   1097.0   NaN
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{visualize\PYZus{}col}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{race\PYZus{}concept\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
8527    175590
0       105715
8515     62879
8516     13861
8557      3511
8657      1075
Name: race\_concept\_id, dtype: int64

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}29}]:} visit\_concept\_id                                0        9201     9202  9203
                                    race\_concept\_id                                  
         ARI\_symptoms\_2\_months\_bool 0                  3820.0    350.0   3930.0   0.0
                                    8515               2496.0    234.0   1987.0   0.0
                                    8516                564.0     60.0    318.0   0.0
                                    8527               6419.0    740.0   3962.0   2.0
                                    8557                192.0     19.0     84.0   NaN
                                    8657                 35.0      4.0     21.0   NaN
         positive                   0                   643.0     37.0     20.0   0.0
                                    8515                 54.0     26.0     13.0   0.0
                                    8516                 11.0      3.0      4.0   0.0
                                    8527                169.0     50.0     45.0   0.0
                                    8557                  3.0      5.0      2.0   NaN
                                    8657                  2.0      0.0      0.0   NaN
         tested                     0                  5235.0    361.0    299.0   0.0
                                    8515               1030.0    218.0    234.0   0.0
                                    8516                234.0     81.0     45.0   0.0
                                    8527               2978.0    740.0    711.0   2.0
                                    8557                 76.0     35.0     12.0   NaN
                                    8657                 17.0      5.0      7.0   NaN
         total                      0                 73684.0   7481.0  24549.0   1.0
                                    8515              44401.0   4173.0  14301.0   4.0
                                    8516              10296.0    850.0   2713.0   2.0
                                    8527             127590.0  13384.0  34601.0  15.0
                                    8557               2591.0    267.0    653.0   NaN
                                    8657                772.0     75.0    228.0   NaN
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_12_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{visualize\PYZus{}col}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gender\PYZus{}concept\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
8532    206195
8507    156321
0          115
Name: gender\_concept\_id, dtype: int64

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}30}]:} visit\_concept\_id                                  0        9201     9202  9203
                                    gender\_concept\_id                                  
         ARI\_symptoms\_2\_months\_bool 0                       3.0      1.0      2.0   NaN
                                    8507                 5796.0    755.0   4932.0   0.0
                                    8532                 7727.0    651.0   5368.0   2.0
         positive                   0                       0.0      0.0      0.0   NaN
                                    8507                  448.0     87.0     43.0   0.0
                                    8532                  434.0     34.0     41.0   0.0
         tested                     0                      14.0      0.0      0.0   NaN
                                    8507                 3815.0    939.0    559.0   2.0
                                    8532                 5741.0    501.0    749.0   0.0
         total                      0                      95.0      6.0     14.0   NaN
                                    8507               109162.0  11793.0  35359.0   7.0
                                    8532               150077.0  14431.0  41672.0  15.0
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{visualize\PYZus{}col}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ethnicity\PYZus{}concept\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
38003564    258219
0            55465
38003563     48947
Name: ethnicity\_concept\_id, dtype: int64

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}31}]:} visit\_concept\_id                                   0      9201   9202  9203
                                    ethnicity\_concept\_id                            
         ARI\_symptoms\_2\_months\_bool 0                       1580     46   2617     0
                                    38003563                2320    237   1273     0
                                    38003564                9626   1124   6412     2
         positive                   0                        548      1      8     0
                                    38003563                 109     27     13     0
                                    38003564                 225     93     63     0
         tested                     0                       4118     16    153     0
                                    38003563                1025    226    159     0
                                    38003564                4427   1198    996     2
         total                      0                      38201   3125  14138     1
                                    38003563               35370   3872   9704     1
                                    38003564              185763  19233  53203    20
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_14_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
