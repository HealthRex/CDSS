#!/usr/bin/env python
"""
Test input and output for FeatureMatrixFactory.
"""

from medinfo.db import DBUtil

# Dictionary mapping from database table name to test data.
FM_TEST_INPUT_TABLES = {
    "labs_columns" : ['pat_id','order_proc_id','order_time','result_time','proc_code','base_name','ord_num_value'],
    "labs_column_types" : ['INTEGER', 'INTEGER', 'TIMESTAMP', 'TIMESTAMP', 'TEXT', 'TEXT', 'TEXT'],
    'labs_data':[
        [1, 1, '2050-01-05 09:44:00', '2050-01-05 09:44:00', 'CBCP', 'WBC', 6],
        [1, 2, '2050-01-07 12:44:00', '2050-01-07 12:44:00', 'CBCP', 'WBC', 5],
        [1, 3, '2050-01-09 23:44:00', '2050-01-09 23:44:00', 'CBCP', 'WBC', 3],

        [1, 4, '2050-01-04 09:44:00', '2050-01-05 09:44:00', 'COMP', 'CO2', 6],
        [1, 5, '2050-01-07 13:44:00', '2050-01-07 12:44:00', 'COMP', 'CO2', 5],

        [1, 6, '2050-01-08 23:44:00', '2050-01-09 23:44:00', 'CBCP', 'HCT', 3],
    ],

    'pt_info_columns' : ['pat_id','Birth'],
    "pt_info_column_types" : ['INTEGER','TIMESTAMP'],
    "pt_info_data" : [
        [1, '1986-04-23 00:00:00']
    ],

    'encounters_columns' : ['pat_id','order_proc_id','AdmitDxDate'],
    "encounters_column_types" : ['INTEGER','INTEGER','TIMESTAMP'],
    "encounters_data" : [
        [1, 1, '2050-01-05 08:00:00'],
        [1, 2, '2050-01-07 10:44:00'],
        [1, 3, '2050-01-09 13:44:00']
    ],

    'diagnoses_columns' : ['pat_id', 'order_proc_id', 'diagnose_time', 'diagnose_code'],
    "diagnoses_column_types" : ['INTEGER','INTEGER','TIMESTAMP','TEXT'],
    "diagnoses_data" : [
        [1, 114, '2050-01-05 09:00:00'],
        [1, 115, '2050-01-07 11:44:00'],
        [1, 116, '2050-01-09 15:44:00']
    ],

    'demographics_columns' : ['pat_id','GenderName', 'RaceName'],
    'demographics_column_types': ['INTEGER','TEXT','TEXT'],
    'demographics_data' : [
        [1, 'Male', 'Caucasian'],
        [2, 'Female', 'Native Hawaiian and Other Pacific Islander'],
        [3, 'Male', 'Hispanic']
    ]
}

# Dictionary mapping from test function to expected output.
FM_TEST_OUTPUT = {
    "test_processPatientEpisodeInput" : [
        { "pat_id": -789, "proc_code": "LABMETB", "normal_results": "0",
            "order_proc_id": "-900",
            "order_time": DBUtil.parseDateValue("5/6/2009 15:00") },
        { "pat_id": -789, "proc_code": "LABMETB", "normal_results": "0",
            "order_proc_id": "-800",
            "order_time": DBUtil.parseDateValue("4/6/2009 16:00") },
        { "pat_id": -789, "proc_code": "LABMETB", "normal_results": "1",
            "order_proc_id": "-750",
            "order_time": DBUtil.parseDateValue("4/26/2009 6:00") },
        { "pat_id": -789, "proc_code": "LABMETB", "normal_results": "1",
            "order_proc_id": "-700",
            "order_time": DBUtil.parseDateValue("4/25/2009 6:00") },
        { "pat_id": -456, "proc_code": "LABMETB", "normal_results": "1",
            "order_proc_id": "-600",
            "order_time": DBUtil.parseDateValue("5/6/2009 15:00") },
        { "pat_id": -456, "proc_code": "LABMETB", "normal_results": "1",
            "order_proc_id": "-400",
            "order_time": DBUtil.parseDateValue("4/25/2009 6:00") },
        { "pat_id": -123, "proc_code": "LABMETB", "normal_results": "0",
            "order_proc_id": "-300",
            "order_time": DBUtil.parseDateValue("4/6/2009 15:00") }
    ],
    "OUTPUT_RAW_TABLE":[['pat_id', 'order_time',
         'HCT.preTimeDays', 'HCT.pre', 'HCT.pre.1d', 'HCT.pre.2d', 'HCT.pre.4d', 'HCT.pre.7d', 'HCT.pre.14d', 'HCT.pre.30d', 'HCT.pre.90d', 'HCT.pre.180d', 'HCT.pre.365d', 'HCT.pre.730d', 'HCT.pre.1460d',
         'HCT.postTimeDays', 'HCT.post', 'HCT.post.1d', 'HCT.post.2d', 'HCT.post.4d', 'HCT.post.7d', 'HCT.post.14d', 'HCT.post.30d', 'HCT.post.90d', 'HCT.post.180d', 'HCT.post.365d', 'HCT.post.730d', 'HCT.post.1460d',
         'Male.preTimeDays', 'Male.pre', 'Male.pre.1d', 'Male.pre.2d', 'Male.pre.4d', 'Male.pre.7d', 'Male.pre.14d', 'Male.pre.30d', 'Male.pre.90d', 'Male.pre.180d', 'Male.pre.365d', 'Male.pre.730d', 'Male.pre.1460d',
         'Male.postTimeDays', 'Male.post', 'Male.post.1d', 'Male.post.2d', 'Male.post.4d', 'Male.post.7d', 'Male.post.14d', 'Male.post.30d', 'Male.post.90d', 'Male.post.180d', 'Male.post.365d', 'Male.post.730d', 'Male.post.1460d'],
['1', '2050-01-05 09:44:00',
 'None', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0',
 '3.58333333333', '1', '0', '0', '1', '1', '1', '1', '1', '1', '1', '1', '1',
 '-54791.4055556', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0',
 'None', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
['1', '2050-01-07 12:44:00',
 'None', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0',
 '1.45833333333', '1', '0', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1',
 '-54793.5305556', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0',
 'None', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
['1', '2050-01-09 23:44:00',
 '-1.0', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1',
 'None', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0',
 '-54795.9888889', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0',
 'None', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
['1', '2050-01-04 09:44:00',
 'None', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0',
 '4.58333333333', '1', '0', '0', '0', '1', '1', '1', '1', '1', '1', '1', '1',
 '-54790.4055556', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0',
 'None', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
['1', '2050-01-07 13:44:00',
 'None', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0',
 '1.41666666667', '1', '0', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1',
 '-54793.5722222', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0',
 'None', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
['1', '2050-01-08 23:44:00',
 'None', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0.0',
 '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1',
 '-54794.9888889', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0',
 'None', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0']],
    "test_buildFeatureMatrix_multiClinicalItem" : [
        [
            "pat_id", "order_proc_id", "proc_code", "order_time", "normal_results",
            "TestItem100.preTimeDays", "TestItem100.pre",
            "TestItem100.pre.1d", "TestItem100.pre.2d", "TestItem100.pre.4d",
            "TestItem100.pre.7d", "TestItem100.pre.14d", "TestItem100.pre.30d",
            "TestItem100.pre.90d", "TestItem100.pre.180d", "TestItem100.pre.365d",
            "TestItem100.pre.730d", "TestItem100.pre.1460d",
            "TestItem100.postTimeDays", "TestItem100.post",
            "TestItem100.post.1d", "TestItem100.post.2d", "TestItem100.post.4d",
            "TestItem100.post.7d", "TestItem100.post.14d", "TestItem100.post.30d",
            "TestItem100.post.90d",	"TestItem100.post.180d", "TestItem100.post.365d",
            "TestItem100.post.730d", "TestItem100.post.1460d",
            "TestItem200.preTimeDays", "TestItem200.pre",
            "TestItem200.pre.1d", "TestItem200.pre.2d",	"TestItem200.pre.4d",
            "TestItem200.pre.7d", "TestItem200.pre.14d", "TestItem200.pre.30d",
            "TestItem200.pre.90d", "TestItem200.pre.180d", "TestItem200.pre.365d",
            "TestItem200.pre.730d", "TestItem200.pre.1460d",
            "TestItem200.postTimeDays",	"TestItem200.post",
            "TestItem200.post.1d", "TestItem200.post.2d", "TestItem200.post.4d",
            "TestItem200.post.7d", "TestItem200.post.14d", "TestItem200.post.30d",
            "TestItem200.post.90d", "TestItem200.post.180d", "TestItem200.post.365d",
            "TestItem200.post.730d", "TestItem200.post.1460d"
        ],
        [
            "-789", "-900", "LABMETB", "2009-05-06 15:00:00", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "38198.8472222", "1",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0"
        ],
        [
            "-789", "-800", "LABMETB", "2009-04-06 16:00:00", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "38228.8055556", "1",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0"
        ],
        [
            "-789", "-750", "LABMETB", "2009-04-26 06:00:00", "1",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "38209.2222222", "1",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0"
        ],
        [
            "-789", "-700", "LABMETB", "2009-04-25 06:00:00", "1",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "38210.2222222", "1",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0"
        ],
        [
            "-456", "-600", "LABMETB", "2009-05-06 15:00:00", "1",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "38168.8055556", "1",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0"
        ],
        [
            "-456", "-400", "LABMETB", "2009-04-25 06:00:00", "1",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "38180.1805556", "1",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0"
        ],
        [
            "-123", "-300", "LABMETB", "2009-04-06 15:00:00", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "38167.8055556", "2",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "38167.8472222", "1",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0"
        ]
    ],
    "test_buildFeatureMatrix_prePostFeatures" : [
        [
            "pat_id", "order_proc_id", "proc_code", "order_time", "normal_results",
            "TestItem100.preTimeDays", "TestItem100.pre",
            "TestItem100.pre.1d", "TestItem100.pre.2d", "TestItem100.pre.4d",
            "TestItem100.pre.7d", "TestItem100.pre.14d", "TestItem100.pre.30d",
            "TestItem100.pre.90d", "TestItem100.pre.180d", "TestItem100.pre.365d",
            "TestItem100.pre.730d", "TestItem100.pre.1460d",
            "TestItem200.postTimeDays",	"TestItem200.post",
            "TestItem200.post.1d", "TestItem200.post.2d", "TestItem200.post.4d",
            "TestItem200.post.7d", "TestItem200.post.14d", "TestItem200.post.30d",
            "TestItem200.post.90d", "TestItem200.post.180d", "TestItem200.post.365d",
            "TestItem200.post.730d", "TestItem200.post.1460d"
        ],
        [
            "-789", "-900", "LABMETB", "2009-05-06 15:00:00", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "38198.8472222", "1",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0"
        ],
        [
            "-789", "-800", "LABMETB", "2009-04-06 16:00:00", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "38228.8055556", "1",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0"
        ],
        [
            "-789", "-750", "LABMETB", "2009-04-26 06:00:00", "1",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "38209.2222222", "1",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0"
        ],
        [
            "-789", "-700", "LABMETB", "2009-04-25 06:00:00", "1",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "38210.2222222", "1",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0"
        ],
        [
            "-456", "-600", "LABMETB", "2009-05-06 15:00:00", "1",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0"
        ],
        [
            "-456", "-400", "LABMETB", "2009-04-25 06:00:00", "1",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0"
        ],
        [
            "-123", "-300", "LABMETB", "2009-04-06 15:00:00", "0",
            "None", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0",
            "38167.8472222", "1",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0", "0",
            "0", "0"
        ]
    ],
    "test_buildFeatureMatrix_multiLabTest" : {
        "expectedLabResults" : [
            {
                "pat_id": -789,
                "base_name": "CR",
                "ord_num_value": 1.0,
                "result_flag": None,
                "result_in_range_yn": None,
                "result_time": DBUtil.parseDateValue("4/6/2009 12:00")
            },
            {
                "pat_id": -789,
                "base_name": "CR",
                "ord_num_value": 0.7,
                "result_flag": None,
                "result_in_range_yn": "Y",
                "result_time": DBUtil.parseDateValue("4/26/2009 6:00")
            },
            {
                "pat_id": -789,
                "base_name": "CR",
                "ord_num_value": 0.3,
                "result_flag": None,
                "result_in_range_yn": "Y",
                "result_time": DBUtil.parseDateValue("4/25/2009 12:00")
            },
            {
                "pat_id": -456,
                "base_name":"TNI",
                "ord_num_value": 9999999,
                "result_flag": None,
                "result_in_range_yn": None,
                "result_time": DBUtil.parseDateValue("4/6/2009 16:34")
            },
            {
                "pat_id": -456,
                "base_name":"CR",
                "ord_num_value": 0.5,
                "result_flag": None,
                "result_in_range_yn":"Y",
                "result_time": DBUtil.parseDateValue("5/6/2009 15:12")
            },
            {
                "pat_id": -123,
                "base_name":"TNI",
                "ord_num_value": 0.2,
                "result_flag": "High Panic",
                "result_in_range_yn": "N",
                "result_time": DBUtil.parseDateValue("4/6/2009 6:36")
            },
            {
                "pat_id": -123,
                "base_name":"CR",
                "ord_num_value": 2.1,
                "result_flag": "High",
                "result_in_range_yn":"N",
                "result_time": DBUtil.parseDateValue("4/6/2009 15:12")
            },
            {
                "pat_id": -123,
                "base_name":"TNI",
                "ord_num_value": 0,
                "result_flag": None,
                "result_in_range_yn": "Y",
                "result_time": DBUtil.parseDateValue("4/6/2009 16:34")
            }
        ],
        "expectedMatrix" : [
            [
                "pat_id", "order_proc_id", "proc_code", "order_time",
                "normal_results",
                "TNI.-90_0.count", "TNI.-90_0.countInRange",
                "TNI.-90_0.min", "TNI.-90_0.max", "TNI.-90_0.median",
                "TNI.-90_0.mean", "TNI.-90_0.std",
                "TNI.-90_0.first", "TNI.-90_0.last", "TNI.-90_0.diff",
                "TNI.-90_0.slope", "TNI.-90_0.proximate",
                "TNI.-90_0.firstTimeDays", "TNI.-90_0.lastTimeDays",
                "TNI.-90_0.proximateTimeDays",
                "CR.-90_0.count", "CR.-90_0.countInRange",
                "CR.-90_0.min", "CR.-90_0.max",	"CR.-90_0.median",
                "CR.-90_0.mean", "CR.-90_0.std",
                "CR.-90_0.first", "CR.-90_0.last", "CR.-90_0.diff",
                "CR.-90_0.slope", "CR.-90_0.proximate",
                "CR.-90_0.firstTimeDays", "CR.-90_0.lastTimeDays",
                "CR.-90_0.proximateTimeDays",
                "LAC.-90_0.count", "LAC.-90_0.countInRange",
                "LAC.-90_0.min", "LAC.-90_0.max", "LAC.-90_0.median",
                "LAC.-90_0.mean", "LAC.-90_0.std",
                "LAC.-90_0.first", "LAC.-90_0.last", "LAC.-90_0.diff",
                "LAC.-90_0.slope", "LAC.-90_0.proximate",
                "LAC.-90_0.firstTimeDays", "LAC.-90_0.lastTimeDays",
                "LAC.-90_0.proximateTimeDays"
            ],
            [
                "-789", "-900", "LABMETB", "2009-05-06 15:00:00",
                "0",
                "0", "0", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "None", "None", "None", "None",
                "None",
                3, 2, 0.3, 1.0, 0.7,
                0.6666666666666666, 0.28674417556808757, 1.0, 0.7, -0.3,
                -0.0151898734177, 0.7, -30.125, -10.375, -10.375,
                "0", "0", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "None", "None",	"None", "None", "None"
            ],
            [
                "-789", "-800", "LABMETB", "2009-04-06 16:00:00",
                "0",
                "0", "0", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None",
                1, 0, 1.0, 1.0, 1.0,
                1.0, 0.0, 1.0, 1.0, 0.0,
                0.0, 1.0, -0.166666666667, -0.166666666667,	-0.166666666667,
                "0", "0", "None", "None", "None",
                "None", "None", "None",	"None",	"None",
                "None",	"None",	"None",	"None",	"None"
            ],
            [
                "-789",	"-750",	"LABMETB",	"2009-04-26 06:00:00",
                "1",
                "0", "0", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "None", "None", "None", "None",	"None",
                2, 1, 0.3, 1.0, 0.65,
                0.65, 0.35,	1.0, 0.3, -0.7,
                -0.0368421052632, 0.3, -19.75, -0.75, -0.75,
                "0", "0", "None", "None", "None",
                "None", "None",	"None",	"None",	"None",
                "None", "None", "None", "None", "None"
            ],
            [
                "-789", "-700", "LABMETB", "2009-04-25 06:00:00",
                "1",
                "0", "0", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None",
                1, 0, 1.0, 1.0, 1.0,
                1.0, 0.0, 1.0, 1.0, 0.0,
                0.0, 1.0, -18.75, -18.75, -18.75,
                "0", "0", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None"
            ],
            [
                "-456", "-600", "LABMETB", "2009-05-06 15:00:00",
                "1",
                "0", "0", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "0", "0", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "0", "0", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None"
            ],
            [
                "-456", "-400", "LABMETB", "2009-04-25 06:00:00",
                "1",
                "0", "0", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "0", "0", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "0", "0", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None"
            ],
            [
                "-123", "-300", "LABMETB", "2009-04-06 15:00:00",
                "0",
                1, 0, 0.2, 0.2, 0.2,
                0.2, 0.0, 0.2, 0.2, 0.0,
                0.0, 0.2, -0.35, -0.35, -0.35,
                "0", "0", "None", "None", "None",
                "None", "None", "None",	"None",	"None",
                "None", "None", "None", "None", "None",
                "0",  "0", "None", "None", "None",
                "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None"
            ]
        ]
    },
    "test_buildFeatureMatrix_multiFlowsheet" : {
        "expectedMatrix" : [
            [
                "pat_id", "order_proc_id", "proc_code", "order_time",
                "normal_results",
                "Resp.-90_0.count", "Resp.-90_0.countInRange",
                "Resp.-90_0.min", "Resp.-90_0.max", "Resp.-90_0.median",
                "Resp.-90_0.mean", "Resp.-90_0.std",
                "Resp.-90_0.first", "Resp.-90_0.last", "Resp.-90_0.diff",
                "Resp.-90_0.slope", "Resp.-90_0.proximate",
                "Resp.-90_0.firstTimeDays", "Resp.-90_0.lastTimeDays",
                "Resp.-90_0.proximateTimeDays",
                "FiO2.-90_0.count", "FiO2.-90_0.countInRange",
                "FiO2.-90_0.min", "FiO2.-90_0.max",	"FiO2.-90_0.median",
                "FiO2.-90_0.mean", "FiO2.-90_0.std",
                "FiO2.-90_0.first", "FiO2.-90_0.last", "FiO2.-90_0.diff",
                "FiO2.-90_0.slope", "FiO2.-90_0.proximate",
                "FiO2.-90_0.firstTimeDays", "FiO2.-90_0.lastTimeDays",
                "FiO2.-90_0.proximateTimeDays",
                "Glasgow Coma Scale Score.-90_0.count",
                "Glasgow Coma Scale Score.-90_0.countInRange",
                "Glasgow Coma Scale Score.-90_0.min",
                "Glasgow Coma Scale Score.-90_0.max",
                "Glasgow Coma Scale Score.-90_0.median",
                "Glasgow Coma Scale Score.-90_0.mean",
                "Glasgow Coma Scale Score.-90_0.std",
                "Glasgow Coma Scale Score.-90_0.first",
                "Glasgow Coma Scale Score.-90_0.last",
                "Glasgow Coma Scale Score.-90_0.diff",
                "Glasgow Coma Scale Score.-90_0.slope",
                "Glasgow Coma Scale Score.-90_0.proximate",
                "Glasgow Coma Scale Score.-90_0.firstTimeDays",
                "Glasgow Coma Scale Score.-90_0.lastTimeDays",
                "Glasgow Coma Scale Score.-90_0.proximateTimeDays"
            ],
            [
                "-789", "-900", "LABMETB", "2009-05-06 15:00:00",
                "0",
                "0", "0", "None", "None", "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None", "None",
                "0", "0", "None", "None", "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None", "None",
                3, 0, 0.3, 1.0, 0.7, 0.6666666666666666, 0.28674417556808757, 1.0,
                0.7, -0.3, -0.0151898734177, 0.7, -30.125, -10.375, -10.375
            ],
            [
                "-789", "-800", "LABMETB", "2009-04-06 16:00:00",
                "0",
                "0", "0", "None", "None", "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None", "None",
                "0", "0", "None", "None", "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None", "None",
                1, 0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0,
                0.0, 1.0, -0.166666666667, -0.166666666667, -0.166666666667
            ],
            [
                "-789", "-750", "LABMETB", "2009-04-26 06:00:00",
                "1",
                "0", "0", "None", "None", "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None", "None",
                "0", "0", "None", "None", "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None", "None",
                2, 0, 0.3, 1.0, 0.65, 0.65, 0.35, 1.0, 0.3,
                -0.7, -0.0368421052632, 0.3, -19.75, -0.75, -0.75
            ],
            [
                "-789", "-700", "LABMETB", "2009-04-25 06:00:00",
                "1", "0", "0", "None", "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None", "None", "None",
                "0", "0", "None", "None", "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None", "None",
                1, 0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0,
                0.0, 1.0, -18.75, -18.75, -18.75
            ],
            [
                "-456", "-600", "LABMETB", "2009-05-06 15:00:00",
                "1",
                "0", "0", "None", "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None", "None", "None",
                "0", "0", "None", "None", "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None", "None",
                0, 0, "None", "None", "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None", "None"
            ],
            [
                "-456", "-400", "LABMETB", "2009-04-25 06:00:00",
                "1",
                "0", "0", "None", "None", "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None", "None",
                "0", "0", "None", "None", "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None", "None",
                0, 0, "None", "None", "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None", "None"
            ],
            [
                "-123", "-300", "LABMETB", "2009-04-06 15:00:00",
                "0",
                "0", "0", "None", "None", "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None", "None",
                "1", "0", "0.2", "0.2", "0.2", "0.2", "0.0", "0.2", "0.2", "0.0",
                "0.0", "0.2", "-0.35", "-0.35", "-0.35",
                0, 0, "None", "None", "None", "None", "None", "None", "None",
                "None", "None", "None", "None", "None", "None"
            ]
        ]
    },
    "test_addTimeCycleFeatures" : {
        "expectedMatrix" : [
            [
                "pat_id", "order_proc_id", "proc_code", "order_time",
                "normal_results", "order_time.month", "order_time.month.sin",
                "order_time.month.cos", "order_time.hour",
                "order_time.hour.sin", "order_time.hour.cos"
            ],
            [   "-789", "-900", "LABMETB", "2009-05-06 15:00:00", "0",
                "5", 0.8660254037844388, -0.4999999999999998,
                "15", -0.7071067811865471, -0.7071067811865479 ],
            [   "-789", "-800", "LABMETB", "2009-04-06 16:00:00", "0",
                "4", 1.0, 6.123233995736766e-17,
                "16", -0.8660254037844384, -0.5000000000000004 ],
            [   "-789", "-750", "LABMETB", "2009-04-26 06:00:00", "1",
                "4", 1.0, 6.123233995736766e-17,
                "6", 1.0, 6.123233995736766e-17 ],
            [   "-789", "-700", "LABMETB", "2009-04-25 06:00:00", "1",
                "4", 1.0, 6.123233995736766e-17,
                "6", 1.0, 6.123233995736766e-17 ],
            [   "-456", "-600", "LABMETB", "2009-05-06 15:00:00", "1",
                "5", 0.8660254037844388, -0.4999999999999998,
                "15", -0.7071067811865471, -0.7071067811865479 ],
            [   "-456", "-400", "LABMETB", "2009-04-25 06:00:00", "1",
                "4", 1.0, 6.123233995736766e-17,
                "6", 1.0, 6.123233995736766e-17 ],
            [   "-123", "-300", "LABMETB", "2009-04-06 15:00:00", "0",
                "4", 1.0, 6.123233995736766e-17,
                "15", -0.7071067811865471, -0.7071067811865479 ]
        ]
    }
}
